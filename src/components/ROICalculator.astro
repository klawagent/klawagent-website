---
import { DollarSign, Clock, Zap, BarChart3, Shield, RefreshCw } from '@lucide/astro';
---

<div class="roi-calculator">
  <div class="calc-header">
    <div class="calc-icon">
      <DollarSign size={32} />
    </div>
    <h3>KlawAgent vs VA Cost Calculator</h3>
    <p>See your potential savings in real-time</p>
  </div>
  
  <div class="calc-inputs">
    <div class="input-group">
      <label for="va-hours">VA Hours per Week</label>
      <input type="number" id="va-hours" min="1" max="50" value="40" />
    </div>
    
    <div class="input-group">
      <label for="va-rate">VA Hourly Rate ($)</label>
      <input type="number" id="va-rate" min="5" max="50" value="10" />
    </div>
  </div>
  
  <div class="calc-results">
    <div class="result-card va-cost">
      <div class="result-label">VA Cost per Month</div>
      <div class="result-value" id="va-monthly">$1,300</div>
    </div>
    
    <div class="result-card platform-cost">
      <div class="result-label">KlawAgent Platform</div>
      <div class="result-value">$147</div>
      <div class="cost-breakdown">
        <small>Fixed monthly fee</small>
      </div>
    </div>
    
    <div class="result-card api-cost">
      <div class="result-label">Estimated API Usage</div>
      <div class="result-value" id="api-cost">$125</div>
      <div class="cost-breakdown">
        <small id="api-breakdown">Based on equivalent workload</small>
      </div>
    </div>
    
    <div class="result-card klawagent-total">
      <div class="result-label">KlawAgent Total Cost</div>
      <div class="result-value" id="klawagent-total">$272</div>
      <div class="cost-breakdown">
        <small>Platform + API usage</small>
      </div>
    </div>
    
    <div class="result-card savings">
      <div class="result-label">Your Monthly Savings</div>
      <div class="result-value" id="monthly-savings">$1,153</div>
    </div>
    
    <div class="result-card yearly">
      <div class="result-label">Your Yearly Savings</div>
      <div class="result-value" id="yearly-savings">$13,836</div>
    </div>
  </div>
  
  <div class="calc-benefits">
    <h4>Plus, KlawAgent works 24/7/365 (not just 20 hours):</h4>
    <div class="benefit-grid">
      <div class="benefit">
        <Clock size={16} />
        No sick days or vacations
      </div>
      <div class="benefit">
        <Clock size={16} />
        Works nights and weekends
      </div>
      <div class="benefit">
        <Zap size={16} />
        Instant responses (no delays)
      </div>
      <div class="benefit">
        <BarChart3 size={16} />
        Handles unlimited volume
      </div>
      <div class="benefit">
        <Shield size={16} />
        Never needs training or management
      </div>
      <div class="benefit">
        <RefreshCw size={16} />
        Perfect consistency every time
      </div>
    </div>
  </div>
  
  <div class="calc-cta">
    <a href="#contact" class="calc-btn">Book a Call - Save $<span id="cta-savings">13,836</span>/Year</a>
  </div>
</div>

<style>
  .roi-calculator {
    background: var(--card);
    border: 2px solid var(--border);
    border-radius: 28px;
    padding: 32px;
    margin: 32px 0;
    box-shadow: 0 8px 0 rgba(0,0,0,.08);
  }
  
  .calc-header {
    text-align: center;
    margin-bottom: 28px;
  }
  
  .calc-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 56px;
    height: 56px;
    background: var(--accent);
    color: white;
    border-radius: 50%;
    margin-bottom: 16px;
  }
  
  .calc-header h3 {
    font-family: var(--serif);
    font-size: 1.5rem;
    margin-bottom: 8px;
    color: var(--text);
  }
  
  .calc-header p {
    color: var(--muted);
    font-size: 0.9rem;
  }
  
  .calc-inputs {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-bottom: 28px;
  }
  
  .input-group {
    display: flex;
    flex-direction: column;
  }
  
  .input-group label {
    font-weight: 600;
    margin-bottom: 8px;
    font-size: 0.875rem;
    color: var(--text);
  }
  
  .input-group input {
    padding: 12px 16px;
    border: 2px solid var(--border);
    border-radius: 12px;
    font-size: 1rem;
    font-weight: 600;
    text-align: center;
    background: var(--bg);
    color: var(--text);
    transition: border-color 0.2s;
  }
  
  .input-group input:focus {
    outline: none;
    border-color: var(--accent);
  }
  
  .calc-results {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
    margin-bottom: 28px;
  }
  
  .result-card {
    background: var(--bg);
    border: 1px solid var(--border-light);
    border-radius: 16px;
    padding: 20px;
    text-align: center;
  }
  
  .result-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--muted);
    margin-bottom: 8px;
    font-weight: 600;
  }
  
  .result-value {
    font-family: var(--serif);
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--text);
  }
  
  .va-cost .result-value {
    color: #dc2626;
  }
  
  .platform-cost .result-value {
    color: var(--accent);
  }
  
  .api-cost .result-value {
    color: #f59e0b;
  }
  
  .klawagent-total .result-value {
    color: var(--accent);
  }
  
  .cost-breakdown {
    margin-top: 4px;
    font-size: 0.65rem;
    color: var(--muted);
    font-weight: 500;
  }
  
  .savings .result-value,
  .yearly .result-value {
    color: #16a34a;
  }
  
  .calc-benefits {
    background: var(--bg);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 28px;
  }
  
  .calc-benefits h4 {
    font-size: 1rem;
    margin-bottom: 16px;
    text-align: center;
    color: var(--text);
  }
  
  .benefit-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }
  
  .benefit {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.875rem;
    color: var(--text);
  }
  
  .benefit svg {
    color: var(--accent);
    flex-shrink: 0;
  }
  
  .calc-cta {
    text-align: center;
  }
  
  .calc-btn {
    display: inline-block;
    background: var(--accent);
    color: white;
    padding: 16px 32px;
    border-radius: 12px;
    text-decoration: none;
    font-weight: 700;
    font-size: 1rem;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  
  .calc-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(185, 28, 28, 0.3);
  }
  
  @media (max-width: 960px) {
    .calc-results {
      grid-template-columns: 1fr 1fr;
    }
  }
  
  @media (max-width: 640px) {
    .calc-inputs,
    .calc-results,
    .benefit-grid {
      grid-template-columns: 1fr;
    }
    
    .roi-calculator {
      padding: 24px 20px;
    }
  }
</style>

<script>
  function calculateROI() {
    const vaHours = parseInt(document.getElementById('va-hours').value) || 20;
    const vaRate = parseInt(document.getElementById('va-rate').value) || 15;
    
    // VA costs (assuming 4.33 weeks per month average)
    const vaMonthlyCost = Math.round(vaHours * vaRate * 4.33);
    const klawagentPlatformCost = 147;
    
    // API cost scaling based on VA hours (more hours = more AI usage)
    // Base: $50 for 10 hours, scales up with diminishing returns
    let klawagentAPICost;
    if (vaHours <= 10) {
      klawagentAPICost = Math.round(vaHours * 5); // $5 per hour equivalent
    } else if (vaHours <= 25) {
      klawagentAPICost = 50 + Math.round((vaHours - 10) * 4); // $4 per additional hour
    } else if (vaHours <= 40) {
      klawagentAPICost = 110 + Math.round((vaHours - 25) * 3); // $3 per additional hour
    } else {
      klawagentAPICost = 155 + Math.round((vaHours - 40) * 2); // $2 per additional hour (very efficient at scale)
    }
    
    const klawagentTotalCost = klawagentPlatformCost + klawagentAPICost;
    
    const monthlySavings = vaMonthlyCost - klawagentTotalCost;
    const yearlySavings = monthlySavings * 12;
    
    // Update displays
    document.getElementById('va-monthly').textContent = `$${vaMonthlyCost.toLocaleString()}`;
    document.getElementById('api-cost').textContent = `$${klawagentAPICost}`;
    document.getElementById('klawagent-total').textContent = `$${klawagentTotalCost}`;
    document.getElementById('monthly-savings').textContent = `$${Math.max(0, monthlySavings).toLocaleString()}`;
    document.getElementById('yearly-savings').textContent = `$${Math.max(0, yearlySavings).toLocaleString()}`;
    document.getElementById('cta-savings').textContent = Math.max(0, yearlySavings).toLocaleString();
    
    // Update API breakdown text based on hours
    const apiBreakdown = document.getElementById('api-breakdown');
    if (vaHours <= 15) {
      apiBreakdown.textContent = 'Light usage - basic automation';
    } else if (vaHours <= 30) {
      apiBreakdown.textContent = 'Moderate usage - active automation';
    } else {
      apiBreakdown.textContent = 'Heavy usage - full business automation';
    }
    
    // Color coding for savings
    const savingsElements = [
      document.getElementById('monthly-savings'),
      document.getElementById('yearly-savings')
    ];
    
    savingsElements.forEach(el => {
      if (monthlySavings <= 0) {
        el.style.color = '#dc2626';
        el.textContent = el.textContent.replace('$', '-$');
      } else {
        el.style.color = '#16a34a';
      }
    });
  }
  
  // Add event listeners
  document.getElementById('va-hours').addEventListener('input', calculateROI);
  document.getElementById('va-rate').addEventListener('input', calculateROI);
  
  // Initial calculation
  calculateROI();
</script>