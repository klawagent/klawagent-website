---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => !data.draft))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout title="Blog" description="Insights on AI automation, business productivity, and the KlawAgent platform.">

  <style>
    .hero-band {
      background: var(--bg-dark);
      color: var(--bg);
      padding: 72px 24px 64px;
      text-align: center;
    }
    .hero-band .eyebrow { font-size: 0.7rem; letter-spacing: 0.18em; text-transform: uppercase; color: var(--accent); margin-bottom: 16px; font-weight: 600; }
    .hero-band h1 { font-family: var(--font-serif); font-size: clamp(2rem, 5vw, 3.5rem); font-weight: 700; line-height: 1.15; }

    .page-wrap { max-width: var(--max-w); margin: 0 auto; padding: 64px 32px 96px; }

    .posts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 28px;
    }

    .post-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 32px;
      text-decoration: none;
      color: var(--text);
      transition: border-color 0.2s, transform 0.2s;
      display: flex;
      flex-direction: column;
    }

    .post-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
    }

    .post-date {
      font-size: 0.75rem;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .post-card h2 {
      font-family: var(--font-serif);
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 12px;
      line-height: 1.3;
    }

    .post-card p {
      font-size: 0.9375rem;
      color: var(--text-muted);
      line-height: 1.6;
      flex: 1;
    }

    .post-link {
      margin-top: 20px;
      font-size: 0.8125rem;
      font-weight: 600;
      color: var(--accent);
      letter-spacing: 0.05em;
    }

    .empty-state {
      text-align: center;
      padding: 80px 0;
      color: var(--text-muted);
    }

    .empty-state h2 {
      font-family: var(--font-serif);
      font-size: 1.75rem;
      margin-bottom: 12px;
      color: var(--text);
    }
  </style>

  <div class="hero-band">
    <p class="eyebrow">Knowledge Base</p>
    <h1>The KlawAgent Blog</h1>
  </div>

  <div class="page-wrap">
    {posts.length === 0 ? (
      <div class="empty-state">
        <h2>Posts coming soon</h2>
        <p>We're working on some great content. Check back shortly.</p>
      </div>
    ) : (
      <div class="posts-grid">
        {posts.map(post => (
          <a href={`/blog/${post.slug}`} class="post-card">
            <p class="post-date">{post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
            <h2>{post.data.title}</h2>
            <p>{post.data.description}</p>
            <span class="post-link">Read More â†’</span>
          </a>
        ))}
      </div>
    )}
  </div>

</Layout>
